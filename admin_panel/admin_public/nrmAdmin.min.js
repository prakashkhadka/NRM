(function(){angular.module("adminApp",["ngRoute"]);angular.module("adminApp").config(["$routeProvider","$locationProvider",n]);function n(n,o){o.html5Mode(true);n.when("/admin",{templateUrl:"/admin/auth/login/login.html",controller:"loginCtrl"}).when("/admin/adminDashboard",{templateUrl:"/admin/adminDashboard/adminDashboard.html",controller:"adminDashboardCtrl"}).when("/admin/waitingRooms",{templateUrl:"/admin/waitingRooms/waitingRooms.html",controller:"waitingRoomsCtrl"}).when("/admin/roomDetail/:roomid",{templateUrl:"/admin/roomDetail/roomDetails.html",controller:"roomDetailCtrl"}).when("/admin/userMessage",{templateUrl:"/admin/userMessage/userMessage.html",controller:"userMessageCtrl"}).when("/admin/deleteRoomFeedback",{templateUrl:"/admin/feedbacks/deleteRoomFeedback.html",controller:"myPostCtrl"}).when("/admin/editRoom/:roomid",{templateUrl:"/admin/editRoom/editRoom.html",controller:"editRoomCtrl"}).when("/admin/login",{templateUrl:"/admin/auth/login/login.html",controller:"loginCtrl"}).when("/admin/register",{templateUrl:"/admin/auth/register/register.html",controller:"registerCtrl"}).when("/admin/logout",{templateUrl:"/admin/auth/logout/logout.html",controller:"logoutCtrl"}).when("/admin/removedRooms",{templateUrl:"/admin/removedRooms/removedRooms.html",controller:"removedRoomsCtrl"}).otherwise({redirectTo:"/admin/adminDashboard"})}})();(function(){angular.module("adminApp").controller("adminDashboardCtrl",["$scope","$location","adminAuthentication",n]);function n(n,o,t){if(!t.isLoggedIn()){o.path("/admin")}}})();(function(){angular.module("adminApp").directive("navigation",n);function n(){return{restrict:"EA",templateUrl:"admin/directives/navigation/navigationView.html",controller:"navigationCtrl"}}})();(function(){angular.module("adminApp").controller("navigationCtrl",["$scope","$location","adminAuthentication",n]);function n(n,o,t){n.currentPath=o.path();n.isLoggedIn=t.isLoggedIn();n.currentAdmin=t.currentAdmin();n.logout=function(){t.adminLogout();n.isLoggedIn=false;o.path("/admin")}}})();(function(){angular.module("adminApp").controller("waitingRoomsCtrl",["$scope","roomData","$location","adminAuthentication",n]);function n(n,o,t,e){if(!e.isLoggedIn()){t.path("/admin")}o.getRooms().then(function(o){n.waitingRooms=o.data},function(o){n.waitingRoomResponseError=o.data})}})();(function(){angular.module("adminApp").controller("removedRoomsCtrl",["$scope","roomData","$location","adminAuthentication",n]);function n(n,o,t,e){if(!e.isLoggedIn()){t.path("/admin")}o.getRemovedRooms().then(function(o){n.removedRooms=o.data},function(o){n.removedRoomResponseError=o.data})}})();(function(){angular.module("adminApp").controller("homeCtrl",["$location","$scope","$http","adminAuthentication",n]);function n(n,o,t,e){if(!e.isLoggedIn()){n.path("/admin")}t({method:"GET",url:"/api/rooms"}).then(function n(t){o.rooms=t.data},function n(t){o.error=t.data});o.remove=function(o){t({method:"DELETE",url:"/adminApi/rooms/"+o,headers:{Authorization:"Bearer "+e.getToken()}}).then(function o(t){console.log("Deleted room data is : "+t);n.path("/deleteRoomFeedback")},function n(o){})}}})();(function(){angular.module("adminApp").service("adminAuthentication",["$http","$window",n]);function n(n,o){var t=function(n){o.localStorage["admin-token"]=n};var e=function(){return o.localStorage["admin-token"]};var i=function(){var n=e();if(n){var t=JSON.parse(o.atob(n.split(".")[1]));return t.exp>Date.now()/1e3}else{return false}};var a=function(){if(i()){var n=e();var t=JSON.parse(o.atob(n.split(".")[1]));return{email:t.email,name:t.firstName,adminName:t.adminName}}};adminRegister=function(o){console.log("Registration detail is sent to server : "+o.adminName);return n.post("/adminApi/adminRegister",o).success(function(n){t(n.token)})};adminLogin=function(o){return n({url:"/adminApi/adminLogin",method:"POST",data:o}).then(function(n){t(n.data.token)},function(n){})};adminLogout=function(){o.localStorage.removeItem("admin-token")};return{currentAdmin:a,saveToken:t,getToken:e,isLoggedIn:i,adminRegister:adminRegister,adminLogin:adminLogin,adminLogout:adminLogout}}})();(function(){angular.module("adminApp").service("roomData",["$http","adminAuthentication",n]);function n(n,o){var t=function(){return n.get("/adminApi/rooms",{headers:{Authorization:"Bearer "+o.getToken()}})};var e=function(){return n.get("/adminApi/removedRooms",{headers:{Authorization:"Bearer "+o.getToken()}})};var i=function(t){return n.get("/adminApi/room/"+t,{headers:{Authorization:"Bearer "+o.getToken()}})};var a=function(t){return n.get("/adminApi/allowToPublic/"+t,{headers:{Authorization:"Bearer "+o.getToken()}})};return{getRooms:t,getRemovedRooms:e,roomDetail:i,allowToPublic:a}}})();(function(){angular.module("adminApp").service("userMessage",["$http","adminAuthentication",n]);function n(n,o){var t=function(){return n.get("/adminApi/getMessage",{headers:{Authorization:"Bearer "+o.getToken()}})};return{getMessage:t}}})();(function(){angular.module("adminApp").controller("userMessageCtrl",["$scope","userMessage","$location","adminAuthentication",n]);function n(n,o,t,e){if(!e.isLoggedIn()){t.path("/admin")}o.getMessage().then(function(o){n.receivedMessage=o.data},function(n){})}})();(function(){angular.module("adminApp").controller("roomDetailCtrl",["$routeParams","$scope","roomData","$location","adminAuthentication",n]);function n(n,o,t,e,i){if(!i.isLoggedIn()){e.path("/admin")}var a=n.roomid;t.roomDetail(a).then(function(n){var t=n.data;o.ORD=t},function(n){});o.allowToPublic=function(n){t.allowToPublic(n);e.path("/admin/waitingRooms")}}})();(function(){angular.module("adminApp").controller("editRoomCtrl",["$location","$scope","$http","$routeParams","adminAuthentication",n]);function n(n,o,t,e,i){if(!i.isLoggedIn()){n.path("/admin")}var a=e.roomid;t({method:"GET",url:"/api/rooms/"+a}).then(function n(t){o.room=t.data},function n(o){});o.update=function(o){console.log("Room to be updated is : "+o.suburb);t.put("/adminApi/rooms/"+o._id,o,{headers:{Authorization:"Bearer "+i.getToken()}}).then(function(o){n.path("/admin/myPost")},function(n){})};o.goHome=function(){n.path("/admin")}}})();(function(){angular.module("adminApp").controller("loginCtrl",["$scope","$location","adminAuthentication",n]);function n(n,o,t){n.adminLogin=function(e){n.formError="";if(!n.admin.adminName||!n.admin.password){n.formError="All fields required, please try again";return false}t.adminLogin(e).then(function(){console.log("Admin Login Successful");o.path("/admin/adminDashboard")});n.adminName="";n.password=""}}})();(function(){angular.module("adminApp").controller("registerCtrl",["$location","$scope","adminAuthentication",n]);function n(n,o,t){if(!t.isLoggedIn()){n.path("/admin")}o.adminRegister=function(e){if(e.password===e.password1&&e.tandc===true){t.adminRegister(e).success(function(){n.path("/admin")})}else{o.message="Both password should match"}}}})();